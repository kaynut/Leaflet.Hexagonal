/*!
 * Leaflet.Hexagonal.js v0.8.0
 * 
 * Copyright (c) 2023-present Knut Wanzenberg
 * Released under the MIT License - https://choosealicense.com/licenses/mit/
 * 
 * https://github.com/kaynut/Leaflet.Hexagonal
 * 
*/
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],i):i(((t=t||self).Leaflet=t.Leaflet||{},t.Leaflet.Hexagonal={}),t.L)}(this,(function(t,i){"use strict";var e=(i=i&&i.hasOwnProperty("default")?i.default:i).Layer.extend({options:{container:document.createElement("CANVAS"),zIndex:void 0,opacity:.5,visible:!0,minZoom:0,maxZoom:18,hexagonVisible:!0,hexagonSize:function(t){return Math.max(32,Math.pow(2,t-5))},hexagonGap:0,hexagonOverhang:20,hexagonMode:"topFlat",hexagonFill:"#fd1",hexagonLine:"#303234",hexagonLineWidth:1,colorStyle:"point0",colorRamp:["#ffdd11","#eeeeee","bb4400"],colorRampFallback:["#ffdd11","#eeeeee","bb4400"],colorWeightProp:"weight",markerVisible:!0,markerFill:"#fd1",markerLine:"#303234",markerLineWidth:1,markerOpacity:1,linkVisible:!0,linkMode:"straight",linkForce:0,linkReach:5e4,linkJoin:1,linkFill:"#fd1",linkLine:"#303234",linkLineWidth:2,linkLineBorder:1,selectionVisible:!0,selectionFill:"rgba(255,255,255,0.2)",selectionLine:"rgba(255,255,255,0.2)",selectionLineWidth:2,infoVisible:!0,infoMode:"count",infoClassName:"leaflet-hexagonal-info-container",infoItemsMax:5},_incNr:0,_incId:0,hexagonSize:0,hexagonals:{},points:[],totals:{count:0,weight:0},links:[],markers:[],markerLayer:!1,selection:{},info:!1,infoLayer:!1,colorRamp:[[0,0,0,1],[255,255,255,1]],images:{default:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAK5JREFUSEvtlMsNgzAQBYcO6CTpIKSElJJKUgolEDognaSE6ElG2gPxrvkckOwTCPTGb1jccPBqDs6nAlzDVVEL9MATmJZ8bVGk8AG4AiPQ7Qmw4Z8U/t0LEA4XMKdI1V/AA5h3VxTuAd7ALX28e6o/O89qsapyDbRbQS5mQtQqHO410HML0X1ReARgIbrWKC5Oy78zI/ofqIlWUXi0gXug5V6INlgNqQBX3fkV/QBZex4ZCtJcsAAAAABJRU5ErkJggg=="},icons:{person:"M9 22V8.775q-2.275-.6-3.637-2.513Q4 4.35 4 2h2q0 2.075 1.338 3.537Q8.675 7 10.75 7h2.5q.75 0 1.4.275.65.275 1.175.8L20.35 12.6l-1.4 1.4L15 10.05V22h-2v-6h-2v6Zm3-16q-.825 0-1.412-.588Q10 4.825 10 4t.588-1.413Q11.175 2 12 2t1.413.587Q14 3.175 14 4q0 .825-.587 1.412Q12.825 6 12 6Z"},
/*!
* Leaflet.CustomLayer.js v2.1.0
* 
* Copyright (c) 2019-present Derek Li
* Released under the MIT License - https://choosealicense.com/licenses/mit/
* 
* https://github.com/iDerekLi/Leaflet.CustomLayer
*/
initialize:function(t){i.setOptions(this,t),i.stamp(this),this._map=void 0,this._container=void 0,this._bounds=void 0,this._center=void 0,this._zoom=void 0,this._instanceUID=Date.now(),this._incNr=1e3*(16777215&Date.now()),this._incId=1e3*(16777215&Date.now()),this.setColorRamp(this.options.colorRamp)},beforeAdd:function(){this._zoomVisible=!0},getEvents:function(){var t={viewreset:this._onLayerViewReset,zoom:this._onLayerZoom,moveend:this._onLayerMoveEnd,zoomend:this._onLayerZoomEnd,click:this._onClick,mousemove:this._onMouseRest};return this._zoomAnimated&&(t.zoomanim=this._onLayerAnimZoom),t},onAdd:function(){this.fire("layer-beforemount"),this._container||this._initContainer(),this.setOpacity(this.options.opacity),window.isNaN(this.options.zIndex)?this.setZIndex(100):this.setZIndex(this.options.zIndex),this.getPane().appendChild(this._container),this._onZoomVisible(),this.fire("layer-mounted"),this.markerLayer=L.layerGroup([]).addTo(this._map),this.markerLayer.needsRefresh=!0,this.markerLayer.markerLayer=!0,this.infoLayer=L.layerGroup([]).addTo(this._map),this.infoLayer.needsRefresh=!0,this.infoLayer.infoLayer=!0,this._update()},onRemove:function(){this.fire("layer-beforedestroy"),this._destroyContainer(),this.fire("layer-destroyed")},_onLayerViewReset:function(){this._reset()},_onLayerAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onLayerZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onLayerMoveEnd:function(){this._isZoomVisible()?this._update():this._zoomHide()},_onLayerZoomEnd:function(){this.onZoomEnd()},_onZoomVisible:function(){this._isZoomVisible()?this._zoomShow():this._zoomHide()},_initContainer:function(){var t=this._container=this.options.container;i.DomUtil.addClass(t,"leaflet-layer"),this._zoomAnimated&&i.DomUtil.addClass(this._container,"leaflet-zoom-animated")},_destroyContainer:function(){i.DomUtil.remove(this._container),delete this._container},_isZoomVisible:function(){var t=this.options.minZoom,i=this.options.maxZoom,e=this._map.getZoom();return e>=t&&e<=i},_zoomShow:function(){this._zoomVisible||(this._zoomVisible=!0,this._map.off({zoomend:this._onZoomVisible},this),this.options.visible&&(this._map.on(this.getEvents(),this),this.getContainer().style.display=""))},_zoomHide:function(){this._zoomVisible&&(this._zoomVisible=!1,this._map.off(this.getEvents(),this),this._map.on({zoomend:this._onZoomVisible},this),this.getContainer().style.display="none")},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),o=i.DomUtil.getPosition(this._container),s=this._map.getSize().multiplyBy(.5),a=this._map.project(this._center,e),r=this._map.project(t,e).subtract(a),l=s.multiplyBy(-n).add(o).add(s).subtract(r);i.Browser.any3d?i.DomUtil.setTransform(this._container,l,n):i.DomUtil.setPosition(this._container,l)},_update:function(){if(!this._map._animatingZoom||!this._bounds){this.__update();var t=this._bounds,e=this._container;this._onDraw(),i.DomUtil.setPosition(e,t.min),this.fire("layer-render")}},__update:function(){var t=this._map.getSize(),e=this._map.containerPointToLayerPoint(t.multiplyBy(-0));this._bounds=new i.Bounds(e,e.add(t.multiplyBy(1))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},getContainer:function(){return this._container},setContainer:function(t){var i=this.getContainer(),e=i.parentNode;return delete this._container,this.options.container=t,this._container||this._initContainer(),this.setOpacity(this.options.opacity),window.isNaN(this.options.zIndex)?this.setZIndex(100):this.setZIndex(this.options.zIndex),e?e.replaceChild(t,i):this.getPane().appendChild(t),this._update(),this},getOpacity:function(){return this.options.opacity},setOpacity:function(t){return this.getContainer().style.opacity=this.options.opacity=1*t,this},getZIndex:function(){return this.options.zIndex},setZIndex:function(t){return this.getContainer().style.zIndex=this.options.zIndex=1*t,this},show:function(){if(!this.options.visible){if(this.options.visible=!0,this._isZoomVisible())return this._map.on(this.getEvents(),this),this.getContainer().style.display="",this._update(),this;this._zoomHide()}},hide:function(){if(this.options.visible)return this.options.visible=!1,this._zoomHide(),this._map.off(this.getEvents(),this),this.getContainer().style.display="none",this},
/*!
* Leaflet.Hexagonal.js v0.8.0
* 
* Copyright (c) 2023-present Knut Wanzenberg
* Released under the MIT License - https://choosealicense.com/licenses/mit/
* 
* https://github.com/kaynut/Leaflet.Hexagonal
* 
*/
addPoint:function(t,i){t=this.validateLatLng(t),"number"!=typeof(i=i||{}).id&&"string"!=typeof i.id&&(i.id=this._genId());var e=this._genNr(),n={id:i.id,_nr:e,_link:this.getLinkPos(i.id),cell:!1,latlng:t,meta:{count:1,weight:i[this.options.colorWeightProp]||1,fill:i.fill||!1},marker:i.marker||!1};this.totals.count+=1,this.totals.weight+=n.meta.weight,this.points.push(n),n.marker&&this.markers.push(n),this.refresh()},addPoints:function(t,i){if(Array.isArray(t)&&t.length){var e,n=(i=i||{}).linked||!0,o=i.latlngPropertyName||!1;if(t[0].latlng&&(o="latlng"),n&&(e=this._genId()),"string"!=typeof o)if(Array.isArray(t[0]))for(r=0;r<t.length;r++){var s=t[r][0]||0,a=t[r][1]||0;n||(e=this._genId()),this.addPoint({lat:a,lng:s},{id:e})}else;else for(var r=0;r<t.length;r++)t[r][o]&&(n||(e=this._genId()),this.addPoint(t[r][o],{id:e}))}},addGeojson:function(t,i){if("string"==typeof t&&t.indexOf("json")){i=i||{};var e=this;return fetch(t).then((t=>t.json())).then((t=>{e.addGeojson(t,i)})),0}if("object"!=typeof t||"string"!=typeof t.type)return 0;if("Point"==t.type&&t.coordinates)return(l=i||{}).id||(l.id=this._genId()),this.addPoint({lng:t.coordinates[0],lat:t.coordinates[1]},l),1;if("MultiPoint"==t.type){for(var n=t.coordinates.length,o=0;o<n;o++){var s=this._genId();this.addPoint({lng:t.coordinates[o][0],lat:t.coordinates[o][1]},{id:s})}return n}if("LineString"==t.type){for(n=t.coordinates.length,s=this._genId(),o=0;o<n;o++)this.addPoint({lng:t.coordinates[o][0],lat:t.coordinates[o][1]},{id:s});return n}if("MultiLineString"==t.type){for(n=0,o=0;o<t.coordinates.length;o++)for(var a=t.coordinates[o],r=(s=this._genId(),0);r<a.length;r++)this.addPoint({lng:a[r][0],lat:a[r][1]},{id:s}),n++;return n}if("Feature"==t.type){var l=t.properties||{};return this.addGeojson(t.geometry,l)}if("FeatureCollection"==t.type){for(n=0,o=0;o<t.features.length;o++){l=t.features[o]?.properties||{};n+=this.addGeojson(t.features[o].geometry,l)}return n}return 0},removePoint:function(t){if(this.points.length<1)return!1;if("number"!=typeof t&&"string"!=typeof t)return!1;for(var i=0;i<this.points.length;i++)if(t===this.points[i].id){var e=this.points[i]._link,n=this.points[i].weight;this.totals.count-=1,this.totals.weight-=n,this.points.splice(i,1);for(var o=0;o<this.points.length;o++)this.points[o]._link>i?this.points[o]._link-=1:this.points[o]._link==i&&(this.points[o]._link=e);return!0}return!1},clearPoints:function(){var t=this.points.length;return this.points=[],this.refresh(),t},addMarker:function(t,i){t.lat=t.lat||0,t.lng=t.lng||0,"number"!=typeof(i=i||{}).id&&"string"!=typeof i.id&&(i.id=this._genId()),i.marker&&this.addPoint(t,i)},removeMarker:function(t){if(this.markers.length<1)return!1;if("number"!=typeof t&&"string"!=typeof t)return!1;for(var i=0;i<this.markers.length;i++)if(t===this.markers[i].id)return this.markers.splice(i,1),!0;return!1},clearMarkers:function(){var t=this.markers.length;return this.markers=[],this.refresh(),t},refresh:function(){var t=this;window.clearTimeout(t._refreshPoints_debounce),t._refreshPoints_debounce=window.setTimeout((function(){t.markerLayer.needsRefresh=!0,t._update()}),50)},_preDraw:function(){var t=L.Browser.retina?2:1,i=this._bounds.getSize();this._container.width=t*i.x,this._container.height=t*i.y,this._container.style.width=i.x+"px",this._container.style.height=i.y+"px";var e=this._map.getZoom(),n=this._container.getContext("2d");L.Browser.retina&&n.scale(t,t);var o=t*i.x,s=t*i.y;this.hexagonals={};var a=this.calcHexagonSize(e);this.hexagonSize=a;for(var r=this._map.getBounds().getNorthWest(),l=this._map.project(r,e),h=(1+this.options.linkReach/this.calcHexagonDiameter())*a*1.1,c=0;c<this.points.length;c++){var f=this.points[c],g=this.getPixels_from_latlng(f.latlng,o,s,h);if(f.visible=g.visible,g.visible){s=this.calcHexagonCell(g.x,g.y,a,l);this.hexagonals[s.cell]||(this.hexagonals[s.cell]=s,this.hexagonals[s.cell].ids={},this.hexagonals[s.cell].cluster={count:0,weight:0},this.hexagonals[s.cell].style={fill:!1}),this.hexagonals[s.cell].point0||(this.hexagonals[s.cell].point0=f,this.hexagonals[s.cell].points={},this.hexagonals[s.cell].style={fill:f.meta.fill||!1}),this.hexagonals[s.cell].points[f.id]=f,this.hexagonals[s.cell].ids[f.id]=f.id,this.hexagonals[s.cell].cluster.count++,this.hexagonals[s.cell].cluster.weight+=f.meta.weight}f.cell=s}if(this.options.markerVisible)for(c=0;c<this.markers.length;c++){var d=this.markers[c],p=this.getPixels_from_latlng(d.latlng,o,s,h);d.visible=p.visible;s=this.calcHexagonCell(p.x,p.y,a,l);this.hexagonals[s.cell]||(this.hexagonals[s.cell]=s,this.hexagonals[s.cell].ids={},this.hexagonals[s.cell].cluster={count:0,weight:0},this.hexagonals[s.cell].style={fill:!1}),this.hexagonals[s.cell].marker0||(this.hexagonals[s.cell].marker0=d,this.hexagonals[s.cell].markers={}),this.hexagonals[s.cell].markers[d.id]=d,this.hexagonals[s.cell].ids[d.id]=d.id,d.cell=s}if(this.links=[],this.options.linkVisible&&this.options.linkMode&&this.points.length>1)for(c=1;c<this.points.length;c++){var m=this.points[c];if(m._link>=0){var u=this.points[m._link];if(u.visible&&m.visible){var y=this.getLinkPath(u,m,a,l);y&&this.links.push({id:u.id,start:u,end:m,path:y})}}}this.totals.cells=Object.keys(this.hexagonals).length,this.totals.markers=this.markers.length,this.totals.count=this.points.length,this.totals.links=this.links.length},_onDraw:function(){var t=performance.now();this._preDraw(),this.onDraw(this._container,this.hexagonals,this.selection,this.links,this.options),this.totals.drawTime=performance.now()-t},onDraw:function(t,i,e,n,o){var s=t.getContext("2d"),a={};e.ids&&(a=e.ids),this.markerLayer.needsRefresh&&this.markerLayer.clearLayers();var r={hexagonFill:this.options.hexagonFill,hexagonLine:this.options.hexagonLine,hexagonLineWidth:this.options.hexagonLineWidth,linkFill:this.options.linkFill,linkLine:this.options.linkLine};if(n.length&&o.linkVisible)for(var l=0;l<n.length;l++)n[l].end.cell.cluster&&("count"==this.options.colorStyle?r.linkFill=this.getColorRampColor(n[l].end.cell.cluster.count,this.totals.count):"weight"==this.options.colorStyle?r.linkFill=this.getColorRampColor(n[l].end.cell.cluster.weight,this.totals.weight):"point0"==this.options.colorStyle?r.linkFill=n[l].end.meta.fill||this.options.linkFill:r.linkFill=this.options.linkFill,this.drawLink(s,n[l],r),a[n[l].id]&&o.selectionVisible&&this.drawLinkSelected(s,n[l]));var h=Object.keys(i);if(h.length)for(var c=0;c<h.length;c++){if(o.hexagonVisible&&i[h[c]].point0&&("count"==this.options.colorStyle?r.hexagonFill=this.getColorRampColor(i[h[c]].cluster.count,this.totals.count):"weight"==this.options.colorStyle?r.hexagonFill=this.getColorRampColor(i[h[c]].cluster.weight,this.totals.weight):"point0"==this.options.colorStyle?r.hexagonFill=i[h[c]].style.fill||this.options.hexagonFill:r.hexagonFill=this.options.hexagonFill,this.drawHexagon(s,i[h[c]],r),o.selectionVisible)){var f=Object.keys(i[h[c]].ids);for(l=0;l<f.length;l++){a[i[h[c]].ids[f[l]]]&&this.drawHexagonSelected(s,i[h[c]])}}this.markerLayer.needsRefresh&&o.markerVisible&&i[h[c]].marker0&&this.drawHexagonMarker(i[h[c]])}this.markerLayer.needsRefresh=!1,this.afterDraw()},afterDraw:function(){},drawHexagon:function(t,i,e){var n=new Path2D(i.path);e.hexagonFill&&(t.fillStyle=e.hexagonFill,t.fill(n)),e.hexagonLine&&(t.strokeStyle=e.hexagonLine,t.lineWidth=e.hexagonLineWidth,t.stroke(n))},drawHexagonMarker:function(t){var i=t.marker0,e=t.marker0.marker;if("object"==typeof e){var n=e.image||e.icon||this.images.default;if("string"!=typeof e.text){var o,s,a,r=e.size||t.size,l=e.fill||this.options.markerFill||"#303234",h=!1;if(t.topPointy?(o=r,s=1.155*r,h=`0 ${.289*r},${.5*r} 0,${1*r} ${.289*r},${1*r} ${.866*r},${.5*r} ${1.155*r},0 ${.866*r}`):(o=1.155*r,s=r,h=`0 ${.5*r},${.289*r} 0,${.866*r} 0,${1.155*r} ${.5*r},${.866*r} ${r},${.289*r} ${r}`),e.image)a=L.divIcon({className:"leaflet-hexagonal-marker",html:`<svg width="${o}" height="${s}" opacity="${this.options.markerOpacity}" >\n\t\t\t\t\t\t<symbol id="hexa${i._nr}"><polygon points="${h}"></polygon></symbol>\n\t\t\t\t\t\t<mask id="mask${i._nr}"><use href="#hexa${i._nr}" fill="#fff" stroke="#000" stroke-width="${this.options.markerLineWidth+1.5}" /></mask>\n\t\t\t\t\t\t<use href="#hexa${i._nr}" fill="${this.options.markerLine}" shape-rendering="geometricPrecision" />\n\t\t\t\t\t\t<image preserveAspectRatio="xMidYMid slice" href="${n}" mask="url(#mask${i._nr})" width="${o}" height="${s}" ></image>\n\t\t\t\t\t\t</svg>`,className:"",iconSize:[o,s],iconAnchor:[o/2,s/2]});else if(e.icon){var c="";this.icons[e.icon]&&(c=`<path opacity="0.75" transform="translate(${o/2-12},${s/2-12})" d="${this.icons[e.icon]}" />`),a=L.divIcon({className:"leaflet-hexagonal-marker",html:`<svg width="${o}" height="${s}" opacity="${this.options.markerOpacity}" >\n\t\t\t\t\t\t<symbol id="hexa${i._nr}"><polygon points="${h}"></polygon></symbol>\n\t\t\t\t\t\t<mask id="mask${i._nr}"><use href="#hexa${i._nr}" fill="#fff" stroke="#000" stroke-width="${this.options.markerLineWidth}" /></mask>\n\t\t\t\t\t\t<use href="#hexa${i._nr}" fill="${l}" stroke="${this.options.markerLine}" stroke-width="${this.options.markerLineWidth}" shape-rendering="geometricPrecision" />\n\t\t\t\t\t\t${c}\n\t\t\t\t\t\t</svg>`,className:"",iconSize:[o,s],iconAnchor:[o/2,s/2]})}L.marker(t.latlng,{icon:a}).addTo(this.markerLayer)}}},drawHexagonSelected:function(t,i){var e=new Path2D(i.path);this.options.selectionFill&&(t.fillStyle=this.options.selectionFill,t.fill(e)),this.options.selectionLine&&(t.strokeStyle=this.options.selectionLine,t.lineWidth=this.options.selectionLineWidth,t.stroke(e))},drawLink:function(t,i,e){var n=new Path2D(i.path);this.options.linkLineBorder&&(t.lineJoin="round",t.strokeStyle=this.options.linkLine,t.lineWidth=this.options.linkLineWidth+2*this.options.linkLineBorder,t.stroke(n)),t.strokeStyle=e.linkFill,t.lineWidth=this.options.linkLineWidth,t.stroke(n)},drawLinkSelected:function(t,i){var e=new Path2D(i.path);this.options.linkLineBorder&&this.options.selectionLine&&(t.lineJoin="round",t.strokeStyle=this.options.selectionLine,t.lineWidth=this.options.linkLineWidth+2*this.options.linkLineBorder,t.stroke(e)),t.strokeStyle=this.options.selectionFill,t.lineWidth=this.options.linkLineWidth,t.stroke(e)},getColorRampColor:function(t,i,e=!0){var n,o=this.colorRamp,s=o.length-1;if(0==(n=t>=i||!i?1:e?Math.log(t)/Math.log(i):t/i))return"rgba("+o[0][0]+","+o[0][1]+","+o[0][2]+","+o[0][3]+")";if(1==n)return"rgba("+o[s][0]+","+o[s][1]+","+o[s][2]+","+o[s][3]+")";n*=s;var a=Math.floor(n);return n-=a,"rgba("+(o[a][0]*(1-n)+o[a+1][0]*n)+","+(o[a][1]*(1-n)+o[a+1][1]*n)+","+(o[a][2]*(1-n)+o[a+1][2]*n)+","+(o[a][3]*(1-n)+o[a+1][3]*n)+")"},setColorRamp:function(t){if(t)if(Array.isArray(t)&&t.length){this.colorRamp=[];for(var i=0;i<t.length;i++)"string"==typeof t[i]?t[i]=this.getRgbaFromColor(t[i]):Array.isArray(t[i])||(t[i]=[0,0,0,1]),t[i][0]=t[i][0]||0,t[i][1]=t[i][1]||0,t[i][2]=t[i][2]||0,t[i][3]=t[i][3]||1,this.colorRamp[i]=t[i];t.length<2&&(this.colorRamp[1]=t[0])}else this.colorRamp=this.colorRampFallback;else this.colorRamp=this.colorRampFallback},getRgbaFromColor:function(t){var i,e,n,o;return t.indexOf("#")?t.indexOf("rgb")?Array.isArray(t)&&4==t.length?t:[0,0,0,1]:(t+=",1",[i,e,n,o]=t.match(/[.0-9]{1,3}/g),[i,e,n,o]):(t=t.toUpperCase()+"FF").length>8?([i,e,n,o]=t.match(/[0-9A-F]{2}/g).map((t=>parseInt(t,16))),[i,e,n,o]):(t+="F",[i,e,n,o]=t.match(/[0-9A-F]{1}/g).map((t=>17*parseInt(t,16))),[i,e,n,o])},_onClick:function(t){var i=this.setSelection(t.latlng);i&&this.setInfo(i),this.onClick(t,i)},onClick:function(t,i){return i},_onMouseRest:function(t){var i=this;window.clearTimeout(i._onMouseRestDebounced_Hexagonal),i._onMouseRestDebounced_Hexagonal=window.setTimeout((function(){var e=i.getSelection(t.latlng);i.onMouseRest(e)}),250)},onMouseRest:function(t){},onZoomEnd:function(){this.markerLayer.needsRefresh=!0,this.selection&&this.setInfo(!1)},setInfo:function(t){if(this.info&&this.infoLayer.clearLayers(),t&&this.options.infoVisible){var i=this._toArray(t.points),e=this.buildInfo(i),n=document.createElement("DIV");n.className="leaflet-hexagonal-info leftTop",n.innerHTML=e;var o=L.divIcon({iconSize:null,html:n,className:this.options.infoClassName});this.info=L.marker(t.latlng,{icon:o,zIndexOffset:1e3}).addTo(this.infoLayer),L.DomEvent.on(this.info,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(this.info,"click",L.DomEvent.stopPropagation)}},buildInfo:function(t){var i="",e="",n="",o=this.options.infoItemsMax;if("count"==this.options.infoMode)return t.length;if("ids"==this.options.infoMode){t.length>o&&(e="<br><span style='float:right'>["+(t.length-o)+" more]</span>"),o=Math.min(t.length,o);for(var s=0;s<o;s++)i+=n+t[s].id,n="<br>";return i+e}if(this.infoCustom){t.length>o&&(e="<br><span style='float:right'>["+(t.length-o)+" more]</span>"),o=Math.min(t.length,o);for(s=0;s<o;s++)i+=n+this.infoCustom(t[s]),n="<br>";return i+e}return t.length},showInfo:function(){if(this.info){var t=document.querySelector(".leaflet-hexagonal-info-container");t&&(t.style.display="block")}},hideInfo:function(){if(this.info){var t=document.querySelector(".leaflet-hexagonal-info-container");t&&(t.style.display="none")}},setSelection:function(t){if(!t)return this.selection=!1,this.setInfo(!1),this.refresh(),!1;var i=this.getSelection(t);return i?(this.selection=i,this.refresh(),i):(this.selection=!1,this.setInfo(!1),this.refresh(),!1)},getSelection:function(t){if(!t)return this.selection;var i=this._map.getSize(),e=this._map.getZoom(),n=this.calcHexagonSize(e),o=(1+this.options.linkReach/this.calcHexagonDiameter())*n*1.1,s=this._map.getBounds().getNorthWest(),a=this._map.project(s,e),r=this.getPixels_from_latlng(t,i.w,i.h,o),l=this.calcHexagonCell(r.x,r.y,n,a);return!!this.hexagonals[l.cell]&&this.hexagonals[l.cell]},calcHexagonSize:function(t){if(this.options.hexagonSize){if("number"==typeof this.options.hexagonSize)return this.options.hexagonSize;if("function"==typeof this.options.hexagonSize)return this.options.hexagonSize(t)}return 16},calcHexagonCell:function(t,i,e,n){if("topPointy"==this.options.hexagonMode)return this.calcHexagonCell_topPointy(t,i,e,n);n=n||{x:0,y:0};var o=this.options.hexagonGap||0,s=(t+n.x)/e,a=(i+n.y)/e,r=1.73205081,l=e-o,h=l/r,c=h/2,f=l/2,g=Math.floor(a+r*s+1),d=Math.floor((Math.floor(2*a+1)+g)/3),p=Math.floor((g+Math.floor(r*s-a+1))/3),m=(d-p/2)*e-n.y,u=p/2*r*e-n.x,y=this._map.containerPointToLatLng([Math.round(u),Math.round(m)]);return{cell:p+"_"+(d-=Math.floor(p/2)),idx:p,idy:d,cx:u,cy:m,px:t,py:i,path:"M"+(u-h)+" "+m+" L"+(u-c)+" "+(m-f)+" L"+(u+c)+" "+(m-f)+" L"+(u+h)+" "+m+" L"+(u+c)+" "+(m+f)+" L"+(u-c)+" "+(m+f)+"Z",latlng:y,size:e,topPointy:!1}},calcHexagonCell_topPointy:function(t,i,e,n){n=n||{x:0,y:0};var o=this.options.hexagonGap||0,s=(t+n.x)/e,a=(i+n.y)/e,r=1.73205081,l=e-o,h=l/r,c=h/2,f=l/2,g=Math.floor(s+r*a+1),d=Math.floor((Math.floor(2*s+1)+g)/3),p=Math.floor((g+Math.floor(r*a-s+1))/3),m=(d-p/2)*e-n.x,u=p/2*r*e-n.y,y=this._map.containerPointToLatLng([m,u]);return{cell:(d-=Math.floor(p/2))+"_"+p,idx:d,idy:p,cx:m,cy:u,px:t,py:i,path:"M"+m+" "+(u-h)+" L"+(m-f)+" "+(u-c)+" L"+(m-f)+" "+(u+c)+" L"+m+" "+(u+h)+" L"+(m+f)+" "+(u+c)+" L"+(m+f)+" "+(u-c)+"Z",latlng:y,size:e,topPointy:!0}},getLinkPath:function(t,i,e,n){t.id;var o,s=t.cell,a=i.cell,r=s.cx-a.cx,l=s.cy-a.cy,h=Math.sqrt(r*r+l*l)/e;if(h<1.1)return!1;for(var c={},f=1/Math.ceil(h),g=f;g<1-f/2;g+=f){var d=s.cx+(a.cx-s.cx)*g,p=s.cy+(a.cy-s.cy)*g;c[(o=this.calcHexagonCell(d,p,e,n)).cell]||(c[o.cell]=o,this.hexagonals[o.cell]||(this.hexagonals[o.cell]={},this.hexagonals[o.cell].ids={}),this.hexagonals[o.cell].link0||(this.hexagonals[o.cell].link0=t,this.hexagonals[o.cell].links={}),this.hexagonals[o.cell].links[t.id]=t,this.hexagonals[o.cell].ids[t.id]=t.id)}if("centered"==this.options.linkMode){var m=1-this.options.linkJoin,u=(s.cx+a.cx)/2,y=(s.cy+a.cy)/2,x=`M${d=s.cx+(u-s.cx)*m} ${p=s.cy+(y-s.cy)*m} L${u} ${y} `;return x+=`L${d=a.cx+(u-a.cx)*m} ${p=a.cy+(y-a.cy)*m}`}if("straight"==this.options.linkMode){m=1-this.options.linkJoin;var _=Object.keys(c);x=`M${d=s.cx+(c[_[0]].cx-s.cx)*m} ${p=s.cy+(c[_[0]].cy-s.cy)*m} `;return x+=`L${c[_[k=0]].cx} ${c[_[k]].cy} `,x+=`L${c[_[k=_.length-1]].cx} ${c[_[k]].cy} `,x+=`L${d=a.cx+(c[_[k]].cx-a.cx)*m} ${p=a.cy+(c[_[k]].cy-a.cy)*m}`}m=1-this.options.linkJoin,_=Object.keys(c),x=`M${d=s.cx+(c[_[0]].cx-s.cx)*m} ${p=s.cy+(c[_[0]].cy-s.cy)*m} `;for(var k=0;k<_.length;k++)x+=`L${c[_[k]].cx} ${c[_[k]].cy} `;return x+=`L${d=a.cx+(c[_[_.length-1]].cx-a.cx)*m} ${p=a.cy+(c[_[_.length-1]].cy-a.cy)*m}`},calcHexagonDiameter:function(){var t=this.hexagonSize,i=this._map.containerPointToLatLng([0,0]),e=this._map.containerPointToLatLng([1.077*t,0]);return this.getDistance(i.lng,i.lat,e.lng,e.lat)},addIcon:function(t,i){"string"==typeof t&&"string"==typeof i&&(i.indexOf("svg")||(this.icons[t]=i))},validateLatLng:function(t){if("object"==typeof t){if("number"==typeof t.lat)return"number"==typeof t.lng?{lat:t.lat,lng:t.lng}:"number"==typeof t.lon?{lat:t.lat,lng:t.lon}:{lat:0,lng:0,nullIsland:!0};if(Array.isArray(t))return{lng:t[0],lat:t[1]}}return{lat:0,lng:0,nullIsland:!0}},getBbox_from_tile15:function(t){t+="AAAAA";for(var i,e=15,n=Math.floor(5),o="",s=0;s<n;s++){for(i="ABIJCDKLQRYZSTabEFMNGHOPUVcdWXefghopijqrwx45yz67klstmnuv018923-_".indexOf(t[s]).toString(4);i.length<3;)i="0"+i;o+=i}var a,r,l=0,h=0;for(s=0;s<e;s++)r=1<<(a=e-s)-1,"1"===o[e-a]?l|=r:"2"===o[e-a]?h|=r:"3"===o[e-a]&&(l|=r,h|=r);var c=360/Math.pow(2,e),f=1e-10,g=(l+f)*c-180,d=180-(h+f)*c,p=(l+1+f)*c-180,m=180-(h+1+f)*c,u=360/Math.PI;return[g,u*Math.atan(Math.exp(m*Math.PI/180))-90,p,u*Math.atan(Math.exp(d*Math.PI/180))-90]},getPixels_from_bbox:function(t,i,e){var n=this._map.latLngToContainerPoint([t[1],t[0]]),o=this._map.latLngToContainerPoint([t[3],t[2]]),s=!0;return(o.x<0||o.y<0||n.x>i||n.y>e)&&(s=!1),{x0:n.x,y0:o.y,x1:o.x,y1:n.y,visible:s}},getPixels_from_latlng:function(t,i,e,n=50){var o=this._map.latLngToContainerPoint([t.lat,t.lng]);return o.x<-n||o.y<-n||o.x>i+n||o.y>e+n?{x:o.x,y:o.y,visible:!1}:{x:o.x,y:o.y,visible:!0}},getLinkPos:function(t){var i=this.points.length;if(i<1)return-1;for(var e=Math.max(0,i-this.options.linkForce-1),n=i-1;n>=e;){if(t==this.points[n].id)return n;n--}return-1},getDistance:function(t,i,e,n){if("object"==typeof t&&"object"==typeof i&&(n=i.lat,e=i.lng,i=t.lat,t=t.lng),i==n&&t==e)return 0;var o=Math.PI/180,s=180/Math.PI,a=i*o,r=n*o,l=(t-e)*o,h=Math.sin(a)*Math.sin(r)+Math.cos(a)*Math.cos(r)*Math.cos(l);return h>1&&(h=1),h=(h=Math.acos(h))*s*111319.49,Math.round(100*h)/100},_toArray:function(t){var i=[];if("object"!=typeof t)return i;var e=Object.keys(t);if(!e.length)return i;e.sort();for(var n=0;n<e.length;n++)i.push(t[e[n]]);return i},_toObject:function(t,i){var e={};if(!Array.isArray(t))return e;if(!t.length)return e;if("string"!=typeof i){if("string"==typeof t[0]||"number"==typeof t[0])for(var n=0;n<t.length;n++)e[t[n]]=t[n];return e}for(n=0;n<t.length;n++)t[n][i]&&(e[t[n][i]]=t[n]);return e},_genUID:function(){return(16777215&Date.now())+"_"+Math.floor(1e6*Math.random())},_genNr:function(){return this._incNr++,this._incNr},_genId:function(){return this._incId++,this._incId},addPoint_tiles15:function(t,i,e){if("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t){"number"!=typeof i&&"string"!=typeof i&&(i=this._genId()),e=e||{};for(var n=Object.keys(t),o=0;o<n.length;o++){var s=this.getBbox_from_tile15(n[o]),a={lng:(s[0]+s[2])/2,lat:(s[1]+s[3])/2},r={id:i,_nr:this._genNr(),_link:this.getLinkPos(i),cell:!1,latlng:a,count:e.count||t[n[o]].count||0,secs:e.secs||t[n[o]].secs||0,dist:e.dist||t[n[o]].dist||0,weight:e.weight||t[n[o]].weight||0,ts:e.ts||t[n[o]].dist||0,marker:!1};this.points.push(r),r.marker&&this.markers.push(r),this.refresh()}}}});function n(t){return i.hexagonal?new e(t):null}i.Hexagonal=e,i.hexagonal=n,t.Hexagonal=e,t.hexagonal=n,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})}));